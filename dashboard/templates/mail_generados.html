{% extends "base.html" %}

{% block titulo %}Historial de Emails{% endblock %}
{% block subtitulo %}Todos los emails generados y verificados.{% endblock %}

{% block contenido %}
<div class="glass card">
  <h3>ğŸ“Š Historial de Emails</h3>

  <!-- ESTADÃSTICAS -->
  <div class="cards-row">
    <div class="info-card info-card--blue">
      <div class="info-card__label">Total Generados</div>
      <div class="info-card__value">{{ total }}</div>
    </div>
    <div class="info-card info-card--green">
      <div class="info-card__label">âœ… Verificados</div>
      <div class="info-card__value">{{ existe_count }}</div>
    </div>
    <div class="info-card info-card--yellow">
      <div class="info-card__label">âŒ No Existen</div>
      <div class="info-card__value">{{ no_existe_count }}</div>
    </div>
  </div>

  <!-- TABLA -->
  {% if emails %}
  <div class="panel">
    <div class="panel__header">
      <h3 class="panel__title">ğŸ“§ Emails ({{ emails|length }} total)</h3>
    </div>

    <table class="table--compact">
      <thead>
        <tr>
          <th>Email</th>
          <th>Nombre</th>
          <th>Proveedor</th>
          <th>Existe</th>
          <th>Fecha</th>
        </tr>
      </thead>
      <tbody>
        {% for e in emails %}
        <tr>
          <td><code>{{ e.email }}</code></td>
          <td>{{ e.nombre }} {{ e.apellido or '' }}</td>
          <td>
            <span class="badge-proveedor">{{ e.proveedor or 'N/A' }}</span>
          </td>
          <td>
            {% if e.existe_en_proveedor == True %}
              <span class="status-badge status-exists">âœ… SÃ­</span>
            {% elif e.existe_en_proveedor == False %}
              <span class="status-badge status-not-exists">âŒ No</span>
            {% else %}
              <span class="status-badge status-pending">â³ Pendiente</span>
            {% endif %}
          </td>
          <td>
            {% if e.created_at %}
              {{ e.created_at[:10] }}
            {% else %}
              -
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% else %}
  <div style="text-align: center; padding: 40px; background: rgba(34, 197, 94, 0.1); border-radius: 12px;">
    <p style="color: var(--text-muted); margin: 0;">
      ğŸ“­ No hay emails generados aÃºn. <a href="{{ url_for('mail_generator') }}" style="color: var(--accent); font-weight: 600; text-decoration: none;">Genera uno ahora â†’</a>
    </p>
  </div>
  {% endif %}
</div>

<!-- Botones de navegaciÃ³n -->
<div style="margin-top: 20px; display: flex; gap: 10px;">
  <a href="{{ url_for('mail_generator') }}" class="btn-link">â† Volver al Generador</a>
  <a href="{{ url_for('general') }}" class="btn-link">â† Dashboard</a>
</div>

{% endblock %}
